{#------------------------------------------------------------------------#}
{#                                                                        #}
{# Show totals for the session tab. Updates when the data changes         #}
{#                                                                        #}
{#------------------------------------------------------------------------#}

<!-- MAIN CARD -->
<div class="card">

    {#    <div class="card-header#}
    {#        {% if status == "Complete" %}#}
    {#            card-header-primary#}
    {#        {% elif status == "Ready" %}#}
    {#            card-header-info#}
    {#        {% elif status == "Fix" %}#}
    {#            card-header-danger#}
    {#        {% endif %}#}
    {#        ">#}
    {#        <h1 class="text-center my-0 py-0 by-0">#}
    {#            {{ status }}#}
    {##}
    {#            <span class="float-right">#}
    {#                <span class="material-icons" style="font-size: 75px">#}
    {##}
    {#                    {% if status == "Complete" %}#}
    {#                        done_outline#}
    {#                    {% elif status == "Ready" %}#}
    {#                        check#}
    {#                    {% elif status == "Fix" %}#}
    {#                        block#}
    {#                    {% endif %}#}
    {##}
    {#                </span>#}
    {#            </span>#}
    {##}
    {#        </h1>#}
    {#    </div>#}

    <div class="card-body">


        <!-- WIZARD STEPS -->
        <!-- We are automatically finished step 1, or we don't see this screen. We can't control step 2, so the only -->
        <!-- steps we worry about are 3-5. -->

        <div class="steps-form">
            <div class="steps-row setup-panel">

                <!-- STEP 1 - LOAD DATA - ALWAYS SET -->
                <div class="steps-step">
                    <span class="btn btn-circle btn-primary">1</span>
                    <p>Load Data</p>
                </div>

                <!-- STEP 2 - ADJUST SETTINGS - NEVER GETS SET - WE DON'T KNOW IF IT HAPPENS, USE HIGHER STATUS TO CHECK -->
                <div class="steps-step">
                    <span class="btn btn-circle
                        {% if session.status == "BC" or session.status == "OS" or session.status == "CO" %}
                            btn-primary
                        {% endif %}
                        ">2</span>
                    <p>Adjust settings (optional)</p>
                </div>

                <!-- STEP 3 - PROCESS BRIDGE CREDITS -->
                <div class="steps-step">
                    <span class="btn btn-circle
                        {% if session.status == "BC" or session.status == "OS" or session.status == "CO" %}
                            btn-primary
                        {% endif %}
                        ">3</span>
                    <p>Process {{ BRIDGE_CREDITS }}</p>
                </div>

                <!-- STEP 4 - PROCESS OFF SYSTEM PAYMENTS -->
                <div class="steps-step">
                    <span class="btn btn-circle
                        {% if session.status == "OS" or session.status == "CO" %}
                            btn-primary
                        {% endif %}
                        ">4</span>
                    <p>Process Off-System Payments</p>
                </div>

                <!-- STEP 5 - COMPLETE -->
                <div class="steps-step">
                    <span class="btn btn-circle
                        {% if session.status == "CO" %}
                            btn-primary
                        {% endif %}
                        ">5</span>
                    <p>Complete</p>
                </div>
            </div>
        </div>

        <!-- PROGRESS ANIMATION -->
        <h2 class="text-center">Progress</h2>
        <div class="animated-progress progress-{{ progress_colour }} mx-auto">
            <span data-progress="{{ progress_percent }}"></span>
        </div>

        <!-- TABLE OF STATS -->
        <div class="col-md-6 col-lg-4">
            <table class="table border table-condensed table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th colspan="2" class="text-center">Stats</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-left">Tables</td>
                        <td class="text-right">{{ totals.tables }}</td>
                    </tr>
                    <tr>
                        <td class="text-left">{{  BRIDGE_CREDITS }} Due</td>
                        <td class="text-right">{{ totals.bridge_credits_due }}</td>
                    </tr>
                    {% if totals.unknown_payment_methods %}
                        <tr>
                            <td class="text-left">Unknown Payment Types</td>
                            <td class="text-right">{{ totals.unknown_payment_methods }}</td>
                        </tr>
                    {% endif %}
                    <tr>
                        <td class="text-left">{{  BRIDGE_CREDITS }} Received</td>
                        <td class="text-right">{{ totals.bridge_credits_received }}</td>
                    </tr>
                    <tr>
                        <td class="text-left">Off System Payments Due</td>
                        <td class="text-right">{{ totals.other_methods_due }}</td>
                    </tr>
                    <tr>
                        <td class="text-left">Off System Payments Received</td>
                        <td class="text-right">{{ totals.other_methods_received }}</td>
                    </tr>
                </tbody>
            </table>
        </div>


        <!-- NEXT STEPS -->

        {% if session.status == "LD" %}
            <h3>Next Steps</h3>
            <ul>
                <li>Optional - Adjust settings for this session, or individuals</li>
                <li>Process Bridge Credits</li>
            </ul>

            <button
                class="btn btn-info"
                hx-post="{% url "club_sessions:process_bridge_credits_htmx" %}"
                hx-vars="club_id:{{ club.id }}, session_id:{{ session.id }}"
                hx-target="#id_pane_session"
            >
                Process {{ BRIDGE_CREDITS }}
            </button>

        {% endif %}
    </div>
</div>

<script>
    $(document).ready( function () {

        // Show animation for the progress bar
        $(".animated-progress span").each(function () {
            $(this).animate(
                {
                    width: $(this).attr("data-progress") + "%",
                },
                1000
            );
            $(this).text($(this).attr("data-progress") + "%");
        });

    });
</script>

