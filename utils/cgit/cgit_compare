#!/bin/bash

# Compare 2 branches
OLD=$1
NEW=$2

if [[ -z $(git status -s) ]]
then
  # Nothing
  echo ""
else
echo "Warning: unsaved changes in current branch"
read -p "Press key to continue..." -n1 -s
fi
# Format the HTML Template
cp utils/cgit/tools/cgit_template.html /tmp/temp.html
sed -i -e "s/!!BRANCH!!/$OLD/g" /tmp/temp.html
sed -i -e "s/!!OTHERBRANCH!!/$NEW/g" /tmp/temp.html

# Now run the diff
git diff -w $OLD $NEW | diff2html -i stdin -s side --su open --htmlWrapperTemplate /tmp/temp.html