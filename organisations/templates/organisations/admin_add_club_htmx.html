{% load crispy_forms_filters %}
{# HTMX Calls this to replace the whole form if org_id is provided.. Also provided empty for a new form. #}

{% load cobalt_tags %}

{# anchor for JS to go to after load #}
<span id="top_of_form"></span>

{% if errors %}
    <span class="cobalt-form-error">{{ errors }}</span>
    <a href="{% url "organisations:admin_add_club" %}" class="btn btn-success cobalt-save">Reset</a>

{% else %}

    <div class="card">
        <div class="card-header card-header-danger">
            <h2>{{ form.name.value|default_if_none:"Add Club" }}</h2>
            {% if club_number %}
                <h3>{{ GLOBAL_ORG }} Club Number: {{ club_number }}</h3>
                <h4>It is not recommended to edit these fields as they will be out of step
                    with the Masterpoints Centre. It is better to first change them in the MPC
                    and then import the club here.</h4>
            {% endif %}
        </div>
        <div class="card-body">

            {# ------ Club Secretary ------- #}

            {% if possible_club_sec_name %}

                <p>Found a club secretary from the Masterpoints Centre: <b>{{ possible_club_sec_name }}</b></p>

                {% if club_secs %}
                    <p>
                        Matches within {{ GLOBAL_TITLE }}:
                        <ul>
                            {% for club_sec in club_secs %}
                                <li>{{ club_sec|cobalt_user_link_short }}</li>
                            {% endfor %}
                        </ul>
                    </p>
                {% else %}
                    <b>No matches for {{ possible_club_sec_name }} (club secretary) found in {{ GLOBAL_TITLE }}</b>
                {% endif %}

            {% endif %}



            <div class="row">
                {#                secretary           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <b>Club Secretary: </b><span id="dummy_name">{{ secretary_name|default_if_none:"Not Set" }}</span>
                        <input type="hidden" id="id_secretary" name="secretary" value="{{ secretary_id|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.secretary.errors }}</span>
                        <button id="id_search_button" type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#userSearchModal1">Edit</button>
                    </div>
                </div>
                {#            state         #}
                <div class="col-md-3">
                    <div class="form-group">
                        {{ form.state|as_crispy_field }}
                    </div>
                </div>
            </div>


            {#        Form        #}

            <div class="row">
                {#                name           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="bmd-label-floating">Club Name</label>
                        <input type="text"
                            name="name"
                            id="id_name"
                            class="form-control"
                            maxlength="50"
                            required
                            value="{{ form.name.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.name.errors }}</span>
                    </div>
                </div>
                {#                org_id         #}
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="bmd-label-floating">{{ GLOBAL_ORG }} Club Number</label>
                        <input type="number" min="0" step="1"
                            name="org_id"
                            id="id_org_id"
                            class="form-control"
                            required
                            value="{{ form.org_id.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.org_id.errors }}</span>
                    </div>
                </div>
            </div>


            <div class="row">
                {#                address1           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="bmd-label-floating">Address Line 1</label>
                        <input type="text"
                            name="address1"
                            id="id_address1"
                            class="form-control"
                            maxlength="100"
                            value="{{ form.address1.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.address1.errors }}</span>
                    </div>
                </div>
                {#                suburb           #}
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="bmd-label-floating">Suburb</label>
                        <input type="text"
                            name="suburb"
                            id="id_suburb"
                            class="form-control"
                            maxlength="50"
                            value="{{ form.suburb.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.suburb.errors }}</span>
                    </div>
                </div>
            </div>

            <div class="row">
                {#                address2           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="bmd-label-floating">Address Line 2</label>
                        <input type="text"
                            name="address2"
                            id="id_address2"
                            class="form-control"
                            maxlength="100"
                            value="{{ form.address2.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.address2.errors }}</span>
                    </div>
                </div>

                {#                postcode           #}
                <div class="col-md-2">
                    <div class="form-group">
                        <label class="bmd-label-floating">Postcode</label>
                        <input type="text"
                            name="postcode"
                            id="id_postcode"
                            class="form-control"
                            maxlength="10"
                            value="{{ form.postcode.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.postcode.errors }}</span>
                    </div>
                </div>
            </div>

            <div class="row">
                {#                bank_bsb           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="bmd-label-floating">Bank BSB Number</label>
                        <input type="number" min="0" step="1"
                            name="bank_bsb"
                            id="id_bank_bsb"
                            class="form-control"
                            maxlength="7"
                            value="{{ form.bank_bsb.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.bank_bsb.errors }}</span>
                    </div>
                </div>
                {#                bank_account           #}
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="bmd-label-floating">Bank Account Number</label>
                        <input type="number" min="0" step="1"
                            name="bank_account"
                            id="id_bank_account"
                            class="form-control"
                            maxlength="7"
                            value="{{ form.bank_account.value|default_if_none:"" }}">
                        <span class="cobalt-form-error">{{ form.bank_account.errors }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endif %}
