{% if things %}

    <div class="table-responsive">
        <table class="table table-hover table-condensed">
            <thead>
                <tr class="text-primary">
                    <th>Session</th>
                    <th>Date</th>
                    <th>Director</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for thing in things %}
                    <tr>
                        <td>{{ thing.description }}</td>
                        <td>{{ thing.session_date }}</td>
                        <td>{{ thing.director.full_name }}</td>
                        <td>
                            <a target="_blank" href="{% url "club_sessions:manage_session" session_id=thing.id %}" class="btn btn-sm btn-success">Edit</a>
                        </td>

                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {% include 'utils/pagination_footer_htmx.html' with hx_target="#id_panel_sessions" %}

{% else %}
    <h3>This club has not run any sessions yet</h3>

{% endif %}

<script>

    // Check if this page goes to the background. Refresh list if user returns.
    var is_foreground = true;

    function checkDocumentVisible() {
        if (document.visibilityState === 'visible' && is_foreground === false) {
            is_foreground = true;

            // get HTMX to refresh list
            postData = {
                'club_id': {{ club.id }},
            };

            const url = '{% url "organisations:club_menu_tab_sessions_htmx" %}';
            htmx.ajax('POST', url, {'target': '#id_panel_sessions', 'values': postData});

        } else if (document.visibilityState !== 'visible' && is_foreground === true) {
            is_foreground = false;
        }
    }

    $(document).ready( function () {
        setInterval(checkDocumentVisible, 1000);
    });

</script>
