{% load crispy_forms_filters %}
{% load humanize %}
{% load cobalt_tags %}

<div class="card" style="min-height: 800px; height: auto">
    <div class="card-header card-header-warning">
        <h2>Communications</h2>
        {% include "organisations/club_menu/comms/nav_htmx.html" with selected="tags" %}
    </div>
    <div class="card-body" id="id_comms_email_tab">

        <h3>Tags</h3>
        <p>Tags are used to arrange members into different groups so you can send specific communications only to those who
            are interested.
            Tags are used for general communication, you don't need to set up tags for things like results publishing.
        </p>

        {% if tags %}

            <div class="table-responsive col-md-6">
                <table class="table table-hover table-condensed">
                    <thead>
                        <tr>
                            <th>Tag Name</th>
                            <th>User with Tag</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for tag in tags %}
                            <tr>
                                <td>{{ tag.tag_name }}</td>
                                <td>{{ tag.uses }}</td>

                                {% include "utils/htmx_confirm_modal.html" with id=tag.id delete_item=tag.tag_name hx_vars=tag.hx_vars hx_target="#id_panel_comms" hx_post=tag.hx_post %}
                                <td><button type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#deleteModal{{ tag.id }}">
                                    Delete Tag
                                </button>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <h4>No tags defined</h4>

        {% endif %}

        <div class="col-md-3 text-nowrap">
            <form
                hx-post="{% url "organisations:club_menu_tab_comms_tags_htmx" %}"
                hx-target="#id_panel_comms"
                hx-vars="club_id:{{ club.id }}"
            >
                <input type="text" name="tag_name" maxlength="50" class=" form-control" placeholder="Add new tag" required="" id="id_tag_name">
                <button name="add" class="btn btn-sm btn-success">Add</button>
            </form>
        </div>
    </div>
</div>
